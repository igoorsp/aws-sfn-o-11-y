fields @message
| parse @message /"execution_arn":"(?<executionArn>[^"]+)"/
| parse @message /"type":"(?<stateType>[^"]+)"/
| parse @message /"event_timestamp":"(?<eventTime>\d+)"/
| stats 
    min(eventTime) as startTime,
    max(eventTime) as endTime,
    count(*) as totalEvents 
    by executionArn
| display executionArn, startTime, endTime, (endTime - startTime)/1000 as durationSeconds
| sort endTime desc





fields @message
| parse @message /"type":"(?<eventType>[^"]+)"/
| parse @message /"execution_arn":"(?<executionArn>[^"]+)"/
| parse @message /"event_timestamp":"(?<eventTime>\d+)"/
| stats latest(eventType) as lastEventType, max(eventTime) as lastEventTime by executionArn
| fields if(lastEventType = "ExecutionSucceeded", "SUCCEEDED",
      if(lastEventType = "ExecutionFailed", "FAILED",
      if(lastEventType = "ExecutionTimedOut", "TIMED_OUT",
      if(lastEventType = "ExecutionAborted", "ABORTED",
      if(lastEventType = "ExecutionStarted", "RUNNING", "PENDING"))))) as executionStatus
| display executionArn, executionStatus, lastEventTime
| sort lastEventTime desc
